## Model Details
This section provides fundamental information about the model, helping stakeholders understand its context and key characteristics.

### Person or organization developing model:
Stanford CRFM, MosaicML. This model was a joint collaboration of [Stanford CRFM](https://crfm.stanford.edu/) and [MosaicML](https://www.mosaicml.com/). Shared by Stanford CRFM.

### Model date:
Not available.

### Model version:
BioMedLM 2.7B. This model was previously known as PubMedGPT 2.7B.

### Model type:
Language model. BioMedLM 2.7B is a GPT-style model and an autoregressive language model. It is a standard GPT-2 implementation (trained with Flash Attention) with the following hyperparameters:

|             |       |
| ----------- | ----- |
| hidden size | 2560  |
| heads       | 20    |
| layers      | 32    |
| vocab size  | 28896 |
| sequence length| 1024      |

### Training details:
This model was trained exclusively on biomedical abstracts and papers from [The Pile](https://pile.eleuther.ai/). The model was trained on [MosaicML Cloud](https://www.mosaicml.com/cloud), a platform designed for large workloads like LLMs. Using the [Composer](https://github.com/mosaicml/composer) training library and [PyTorch FSDP](https://pytorch.org/docs/stable/fsdp.html), it was easy to enable multi-node training across 128 A100-40GB GPUs, and the total run was completed in ~6.25 days. The model was trained with batch size=1024 and sequence length=1024 for 300B tokens using Decoupled AdamW with the following settings:

|  |  |
| --- | ------ |
| lr  | 1.6e-4 |
| eps | 1e-8       |
| betas | \[0.9, 0.95\]      |
| weight decay    |  1.6e-5      |

The training process was very smooth and did not suffer from any divergences.

### Paper or other resource for more information:
[BioMedLM: A 2.7B Parameter Language Model Trained On Biomedical Text](https://arxiv.org/abs/2403.18421)

### Citation details:
Not available.

### License:
[bigscience-bloom-rail-1.0](https://huggingface.co/spaces/bigscience/license). This model is licensed under the terms of [BigScience Open RAIL-M license](https://huggingface.co/spaces/bigscience/license) used for [BLOOM](https://huggingface.co/bigscience/bloom-1b1). Please note that, among other restrictions, this license forbids use of the model (or derivatives thereof) "To provide medical advice and medical results interpretation."

### Contact:
If you are concerned that your use case would follow under the "letter" of the use restriction, but not the "spirit," you can contact us to discuss.

---

## Intended Use
This section outlines the intended applications of the model.

### Primary intended uses:
BioMedLM 2.7B is a language model trained exclusively on biomedical abstracts and papers. This GPT-style model can achieve strong results on a variety of biomedical NLP tasks, including a new state of the art performance of 50.3% accuracy on the MedQA biomedical question answering task. The main way we have used this model is finetuning for downstream question answering tasks, and we recommend using this model that way. As an autoregressive language model, BioMedLM 2.7B is also capable of natural language generation. However, we emphasize that this model’s generation capabilities are for research purposes only and not suitable for production. In releasing this model, we hope to advance both the development of biomedical NLP applications and best practices for responsibly training and utilizing domain-specific language models; issues of reliability, truthfulness, and explainability are top of mind for us.

### Primary intended users:
This model is intended for research purposes to advance the development of biomedical NLP applications and best practices for responsibly training and utilizing domain-specific language models.

### Out-of-scope uses:
We do not recommend using this model for natural language generation in a production environment, finetuned or otherwise. This license forbids use of the model (or derivatives thereof) "To provide medical advice and medical results interpretation." It should not be directly used for production or work that may directly impact people.

---

## How to Use
This section outlines how to use the model.

It is possible to use this model to generate text, which is useful for experimentation and understanding its capabilities.

---

## Factors
This section addresses variables that may impact the model's performance.

### Relevant factors:
Bias and fairness issues with language models. Predictions generated by the model may include disturbing and harmful stereotypes across protected classes; identity characteristics; and sensitive, social, and occupational groups.

### Evaluation factors:
Not available.

---

## Metrics
This section describes how the model's performance is evaluated.

### Model performance measures:
Accuracy. The model achieves a state of the art performance of 50.3% accuracy on the MedQA biomedical question answering task.

### Decision thresholds:
Not available.

### Variation approaches:
Not available.

---

## Evaluation Data
This section provides details about the datasets used to evaluate the model.

### Datasets:
MedQA biomedical question answering task.

### Motivation:
Not available.

### Preprocessing:
Not available.

---

## Training Data
This section provides details about the datasets used to train the model.

### Datasets:
Pubmed Abstracts and Full Text from [The Pile](https://pile.eleuther.ai/).

### Motivation:
This model was trained exclusively on biomedical text. When building domain specific models we have found it important to use a tokenizer trained on in-domain text to maximize performance on downstream tasks. A key benefit is that common biomedical terms are represented as entire tokens.

### Preprocessing:
The model uses a custom tokenizer trained on the PubMed Abstracts. For instance, all of these following terms are tokenized into single tokens by the biomedical tokenizer and multiple tokens by the standard GPT-2 tokenizer:

|   |   |
| --- | --- |
| chromatography |   chrom/atography |
| cytotoxicity |   cyt/ot/oxicity |
| Immunohistochemistry |   Immun/oh/ist/ochemistry |
| photosynthesis |   photos/ynthesis |
| probiotic |   prob/iotic |

This allows the model to encode information about these concepts in their individual token representations rather than spread out across subword tokens like “oh” shared with many other terms.

---

## Quantitative Analyses
This section presents disaggregated evaluation results.

### Unitary results:
Not available.

### Intersectional results:
Not available.

---

## Memory or Hardware Requirements
This section outlines the memory or hardware requirements for loading, deploying, and training the model.

### Loading Requirements:
Not available.

### Deploying Requirements:
Not available.

### Training or Fine-tuning Requirements:
128 A100-40GB GPUs.

---

## Ethical Considerations
This section discusses the ethical considerations in model development, including challenges, risks, and solutions.

Issues of reliability, truthfulness, and explainability are top of mind for us. Significant research has explored bias and fairness issues with language models. Predictions generated by the model may include disturbing and harmful stereotypes across protected classes; identity characteristics; and sensitive, social, and occupational groups.

---

## Caveats and Recommendations
This section lists unresolved issues and provides guidance for users.

### Caveats:
We have only begun to explore the generation capabilities and limitations of this model. Understanding these limitations is especially important in a domain like medicine.

### Recommendations:
We strongly recommend against using this model in production for natural language generation. It should not be directly used for production or work that may directly impact people.

---

## Additional Information

#  Table of Contents

- [Model Card for BioMedLM 2.7B](#model-card-for--model_id-)
- [Table of Contents](#table-of-contents)
- [Model Details](#model-details)
  - [Model Description](#model-description)
- [Uses](#uses)
  - [Downstream Use](#downstream-use)
  - [Out-of-Scope Use](#out-of-scope-use)
- [Bias, Risks, and Limitations](#bias-risks-and-limitations)
  - [Recommendations](#recommendations)
- [Training Details](#training-details)
  - [Training Data](#training-data)
  - [Training Procedure](#training-procedure)
    - [Preprocessing](#preprocessing)
- [Environmental Impact](#environmental-impact)
- [Technical Specifications](#technical-specifications)
  - [Model Architecture and Objective](#model-architecture-and-objective)
  - [Compute Infrastructure](#compute-infrastructure)

# Model Details

## Model Description

BioMedLM 2.7B is new language model trained exclusively on biomedical abstracts and papers from [The Pile](https://pile.eleuther.ai/). This GPT-style model can achieve strong results on a variety of biomedical NLP tasks, including a new state of the art performance of 50.3% accuracy on the MedQA biomedical question answering task.

As an autoregressive language model, BioMedLM 2.7B is also capable of natural language generation. However, we have only begun to explore the generation capabilities and limitations of this model, and we emphasize that this model’s generation capabilities are for research purposes only and not suitable for production. In releasing this model, we hope to advance both the development of biomedical NLP applications and best practices for responsibly training and utilizing domain-specific language models; issues of reliability, truthfulness, and explainability are top of mind for us.

This model was a joint collaboration of [Stanford CRFM](https://crfm.stanford.edu/) and [MosaicML](https://www.mosaicml.com/).

- **Developed by:** Stanford CRFM, MosaicML
- **Shared by:** Stanford CRFM
- **Model type:** Language model
- **Language(s) (NLP):** en
- **License:**  [bigscience-bloom-rail-1.0](https://huggingface.co/spaces/bigscience/license)

# Uses

This model is licensed under the terms of [BigScience Open RAIL-M license](https://huggingface.co/spaces/bigscience/license) used for [BLOOM](https://huggingface.co/bigscience/bloom-1b1). Please note that, among other restrictions, this license forbids use of the model (or derivatives thereof)
"To provide medical advice and medical results interpretation." If you are concerned that your use case would follow under the "letter" of this restriction, but not the "spirit," you can contact us to discuss.

## Direct Use

It is possible to use this model to generate text, which is useful for experimentation and understanding its capabilities. It should not be directly used for production or work that may directly impact people.

## Downstream Use

The main way we have used this model is finetuning for downstream question answering tasks, and we recommend using this model that way.

## Out-of-Scope Use

We do not recommend using this model for natural language generation in a production environment, finetuned or otherwise.

# Bias, Risks, and Limitations

Significant research has explored bias and fairness issues with language models (see, e.g., [Sheng et al. (2021)](https://aclanthology.org/2021.acl-long.330.pdf)). Predictions generated by the model may include disturbing and harmful stereotypes across protected classes; identity characteristics; and sensitive, social, and occupational groups.

## Recommendations

While this model is capable of generating natural language text, we have only begun to explore this capability and its limitations. Understanding these limitations is especially important in a domain like medicine. Therefore, **we strongly recommend against using this model in production for natural language generation.**

# Training Details

## Training Data

This model was trained on the Pubmed Abstracts and Full Text from [The Pile](https://pile.eleuther.ai/).

## Training Procedure

The model was trained on [MosaicML Cloud](https://www.mosaicml.com/cloud), a platform designed for large workloads like LLMs. Using the [Composer](https://github.com/mosaicml/composer) training library and [PyTorch FSDP](https://pytorch.org/docs/stable/fsdp.html), it was easy to enable multi-node training across 128 A100-40GB GPUs, and the total run was completed in ~6.25 days. The model was trained with batch size=1024 and sequence length=1024 for 300B tokens using Decoupled AdamW with the following settings:

|  |  |
| --- | ------ |
| lr  | 1.6e-4 |
| eps | 1e-8       |
| betas | \[0.9, 0.95\]      |
| weight decay    |  1.6e-5      |

The training process was very smooth and did not suffer from any divergences.

As we were preparing the training run, we were unsure of the benefits of training out to 300B tokens for language model perplexity and downstream task performance. While most models of this scale (e.g. GPT Neo 2.7B) are trained to 300-400B tokens, the datasets those models use are vastly larger than PubMed. For instance, The Pile is 8x the size of its PubMed subcorpora.

Fortunately, we did continue to see steady perplexity improvements on the validation and training sets for the entirety of training, and preliminary experiments showed improved downstream task performance as we trained out to the full 300B tokens. Our takeaway from this was that it was indeed worth it to train for the full 300B tokens, even though this represented dramatically more passes through the data than comparable models.

### Preprocessing

The model uses a custom tokenizer trained on the PubMed Abstracts. When building domain specific models we have found it important to use a tokenizer trained on in-domain text to maximize performance on downstream tasks. A key benefit is that common biomedical terms are represented as entire tokens.

For instance, all of these following terms are tokenized into single tokens by the biomedical tokenizer and multiple tokens by the standard GPT-2 tokenizer:

|   |   |
| --- | --- |
| chromatography |   chrom/atography |
| cytotoxicity |   cyt/ot/oxicity |
| Immunohistochemistry |   Immun/oh/ist/ochemistry |
| photosynthesis |   photos/ynthesis |
| probiotic |   prob/iotic |

This allows the model to encode information about these concepts in their individual token representations rather than spread out across subword tokens like “oh” shared with many other terms.

# Technical Specifications

## Model Architecture and Objective

BioMedLM 2.7B is a standard GPT-2 implementation (trained with Flash Attention) with the following hyperparameters:

|             |       |
| ----------- | ----- |
| hidden size | 2560  |
| heads       | 20    |
| layers      | 32    |
| vocab size  | 28896 |
| sequence length| 1024      |

## Compute Infrastructure

The model was trained on [MosaicML Cloud](https://www.mosaicml.com/cloud), a platform designed for large workloads like LLMs. Using the [Composer](https://github.com/mosaicml/composer) training library and [PyTorch FSDP](https://pytorch.org/docs/stable/fsdp.html), it was easy to enable multi-node training across 128 A100-40GB GPUs, and the total run was completed in ~6.25 days.